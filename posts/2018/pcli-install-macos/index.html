<!DOCTYPE html>
<html lang="en" class="wf-firasans-n4-active wf-active">
	<head>
    <link href="http://gmpg.org/xfn/11" rel="profile">
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <!-- Enable responsiveness on mobile devices -->
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1">
    
    
    <meta name="generator" content="Hugo 0.37.1" />
    
    <title>PowerCLI - MacOS Installation &middot; </title>
    <meta content="PowerCLI - MacOS Installation - " property="og:title">
    <meta content=" - " property="og:description">
    <!-- CSS -->
    <link href="https://fonts.googleapis.com/css?family=Noto+Serif:300,300i,400,400i,700,700i|Source+Code+Pro:300,300i,400,400i" rel="stylesheet">
    <link rel="stylesheet" href="https://kmruddy.github.iocss/print.css" media="print">
    <link rel="stylesheet" href="https://kmruddy.github.iocss/poole.css">
    <link rel="stylesheet" href="https://kmruddy.github.iocss/hyde.css">
    <!-- Font-Awesome -->
    <script defer src="https://use.fontawesome.com/releases/v5.0.13/js/all.js" integrity="sha384-xymdQtn1n3lH2wcu0qhcdaOpQwyoarkgLVxC/wZ5q7h9gHtxICrpcaSUfygqZGOe" crossorigin="anonymous"></script>
    <!-- highlight.js-->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/styles/default.min.css">
    <!-- Customised CSS -->
    <link rel="stylesheet" href="https://kmruddy.github.iocss/custom.css">
    <!-- HTML5 shim and Respond.js for IE8 support of HTML5 elements and media queries -->
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
    <![endif]-->
    <!-- Icons -->
    <link rel="apple-touch-icon-precomposed" sizes="144x144" href="/apple-touch-icon-144-precomposed.png">
    <link rel="shortcut icon" href="/favicon.png">
    

	</head>
    <body class=" ">
        <div class="sidebar">
  <div class="container text-center ">
    <div class="sidebar-about text-center">
      <a href="https://kmruddy.github.io"> <img src="/img/kmr.jpg" alt="Author Image" class="img-circle headshot center"> </a>
      <a href="https://kmruddy.github.io"><h1 class="brand">kmruddy.com</h1></a>
      <p class="lead">
         My notes and ramblings, normally about automation 
      </p>
    </div>
    <p>
      <section class="row text-center">
	
	<a href="https://twitter.com/kmruddy"><i class="fab fa-twitter fa-lg" aria-hidden="true"></i></a>
	
	
	
	&nbsp;<a href="https://github.com/kmruddy"><i class="fab fa-github fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
	&nbsp;<a href="https://linkedin.com/in/kmruddy"><i class="fab fa-linkedin fa-lg" aria-hidden="true"></i></a>
	
	
	&nbsp;<a href="https://stackoverflow.com/users/kmruddy"><i class="fab fa-stack-overflow fa-lg" aria-hidden="true"></i></a>
	
	
	
	
	
</section>

    </p>
    <p>
      
<div>
	<ul class="sidebar-nav">
		
		
				<li>
					<a href="/"> <span>Home</span></a>
				</li>
				<li>
					<a href="/about/"> <span>About</span></a>
				</li>
				<li>
					<a href="/catagories/posh"> <span>PowerShell</span></a>
				</li>
				<li>
					<a href="/catagories/pcli"> <span>PowerCLI</span></a>
				</li>
				<li>
					<a href="/catagories/vbrownbag"> <span>vBrownBag</span></a>
				</li>
		</li>
	</ul>
</div>

    </p>
    <p class="copyright">&copy; 2018 Kyle Ruddy.<br />
      <a href="https://creativecommons.org/licenses/by/4.0">Some Rights Reserved</a>.<br/>Built with <a href="https://gohugo.io/">Hugo</a> &amp; <a href="https://github.com/htr3n/hyde-hyde">hyde-hyde</a>.
    </p>
  </div>
  <div>
  </div>
</div>

        <div class="content container">
            <div class="post">
  <h1>PowerCLI - MacOS Installation</h1>
  
  <div class="col-sm-12 col-md-12">
    <span class="text-left post-date meta">
            
       
        <i class="fas fa-calendar-alt"></i> Mar 27, 2018
      
      
      
      
        
        
            <br/>
             <i class="fas fa-tags"></i>
            
            <a class="meta" href="/tags/powercli">powercli</a> 
        
            <a class="meta" href="/tags/powershell">powershell</a> 
        
            <a class="meta" href="/tags/vmware">vmware</a>
        
      
      
      <br/>
      <i class="fas fa-clock"></i> 3 min read 
      </span>  
  </div>    
  
  

<p>PowerCLI 10.0.0 was released just a few weeks ago and one of the key updates was the added support for MacOS and Linux operating systems. It’s still amazing to think about! PowerShell and PowerCLI available to users on OSes other than just Windows. Wow!</p>

<p>Let’s put this to action and get PowerCLI installed on a MacOS system.</p>

<h2 id="prerequisite-installing-powershell-core-package">Prerequisite: Installing PowerShell Core – Package</h2>

<p>The minimally required version for MacOS is PowerShell Core 6.0.1. There’s a couple different ways to install PowerShell onto a MacOS system. This first method is downloading the PowerShell package and installing it through GUI installer. We can start by browsing to the <a href="https://github.com/PowerShell/PowerShell">PowerShell GitHub repository</a>, and clicking on the ‘Releases’ button. Alternatively, here’s a direct link: <a href="https://github.com/PowerShell/PowerShell/releases">PowerShell Releases page</a></p>

<p><img src="http://blogs.vmware.com/PowerCLI/files/2018/03/pclimos_00.jpg" alt="Example: PowerShell Repo Releases Page" /></p>

<p>On the PowerShell Releases page, we will want to download the latest MacOS package to our local system. Now, we will want to run through the installer. Accepting all of the defaults worked in my environment.</p>

<p><img src="http://blogs.vmware.com/PowerCLI/files/2018/03/pclimos_01.jpg" alt="Example: PowerShell Core Package Install" /></p>

<h2 id="prerequisite-installing-powershell-homebrew">Prerequisite: Installing PowerShell – Homebrew</h2>

<p>The other main way of installing PowerShell is through <a href="https://brew.sh/">Homebrew</a>. Homebrew is a package manager. It will easily allow us to install, update, and remove packages, like PowerShell, directly from the command line! If you don’t already have Homebew installed, it too can be installed from the command line with the following within Terminal:</p>

<pre><code>/usr/bin/ruby -e &quot;$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)&quot;
</code></pre>

<p>Next, we’ll need to install <a href="https://caskroom.github.io/">Homebrew-Cask</a>. Homebrew-Cask is extension of Homebrew to allow for the downloading of additional, pre-compiled, applications. We will perform the install with the following command within Terminal:</p>

<pre><code>brew tap caskroom/cask
</code></pre>

<p>Now, we’re ready to install PowerShell onto our MacOS system! This can be done with the following command within Terminal:</p>

<pre><code>brew cask install powershell
</code></pre>

<p><img src="http://blogs.vmware.com/PowerCLI/files/2018/03/pclimos_02.jpg" alt="Example: Installing PowerShell Core through Homebrew Cask" /></p>

<h2 id="installing-powercli">Installing PowerCLI</h2>

<p>We have our prerequisite of PowerShell installed on our MacOS system. We’re now ready to install PowerCLI! Start by opening Terminal and starting our PowerShell session by entering:</p>

<pre><code>pwsh
</code></pre>

<p><img src="http://blogs.vmware.com/PowerCLI/files/2018/03/pclimos_05.jpg" alt="Example: Launching the PowerShell Core terminal" /></p>

<p>At this point, we’re in PowerShell so we install PowerCLI just like we have for the past couple versions!</p>

<p>Example:</p>

<pre><code>Install-Module -Name VMware.PowerCLI -Scope CurrentUser
</code></pre>

<p><img src="http://blogs.vmware.com/PowerCLI/files/2018/03/pclimos_03.jpg" alt="Example: Installing PowerCLI with PowerShell Core" /></p>

<p>At this point, we’re all set! We can start using PowerCLI just like we normally have on Windows systems for years!</p>

<p><img src="http://blogs.vmware.com/PowerCLI/files/2018/03/pclimos_04.jpg" alt="Example: Connecting to a vCenter Server" /></p>

<h2 id="couple-things-to-keep-in-mind">Couple Things to Keep in Mind</h2>

<p>There are still a couple things to keep in mind as you move forward in the excitement of having PowerCLI on a non-Windows system. PowerShell Core, as well as the underlying .NET Core, are not feature complete to their non-Core counterparts. Make sure to test your scripts thoroughly prior to using them. A recent example that was brought up within the PowerCLI channel in the VMware Code Slack group: ConvertFrom-SecureString doesn’t currently work, as per <a href="https://github.com/PowerShell/PowerShell/issues/1654">Issue 1654</a>. Therefore, if you have any scripts containing secure string objects, PowerShell Core will not be able to decrypt them.</p>

<p>The PowerCLI 10.0.0 release starts with support for the following modules, and the rest of the modules will be added over time:</p>

<ul>
<li>VMware.VimAutomation.Cis.Core</li>
<li>VMware.VimAutomation.Common</li>
<li>VMware.VimAutomation.Core</li>
<li>VMware.VimAutomation.Nsxt</li>
<li>VMware.VimAutomation.Vds</li>
<li>VMware.VimAutomation.Vmc</li>
<li>VMware.VimAutomation.Sdk</li>
<li>VMware.VimAutomation.Storage</li>
<li>VMware.VimAutomation.StorageUtility</li>
</ul>

<p>Some cmdlets, even though they may be in the above list, also still may not function properly. Examples:</p>

<ul>
<li>Get-VICredentialStoreItem</li>
<li>New-VICredentialStoreItem</li>
<li>Remove-VICredentialStoreItem</li>
<li>Get-VMHostHardware</li>
<li>Open-VMConsoleWindow</li>
</ul>

<h2 id="wrap-up">Wrap-Up</h2>

<p>The PowerCLI 10.0.0 release added the much requested support for MacOS and Linux systems! In this blog, we walked through two different methods to make PowerShell Core available on MacOS and how to install PowerCLI.</p>

</div>
            <div class="footer">
                <script src="//cdnjs.cloudflare.com/ajax/libs/highlight.js/9.12.0/highlight.min.js"></script>

<script type="text/javascript">
    hljs.configure({languages: []});
    hljs.initHighlightingOnLoad();
</script>

    

            </div>
        </div>
        
        
    </body>
</html>
